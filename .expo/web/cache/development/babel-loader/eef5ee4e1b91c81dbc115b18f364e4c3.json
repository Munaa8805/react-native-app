{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { useContext, useLayoutEffect, useState } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport View from \"react-native-web/dist/exports/View\";\nimport ExpenseForm from \"../components/ManageExpense/ExpenseForm\";\nimport Button from \"../components/UI/Button\";\nimport IconButton from \"../components/UI/IconButton\";\nimport { GlobalStyles } from \"../constants/styles\";\nimport { ExpensesContext } from \"../store/expenses-context\";\nimport { storeExpense, updateExpense, deleteExpense } from \"../util/http\";\nimport LoadingOverlay from \"../components/UI/LoadingOverlay\";\nimport ErrorOverlay from \"../components/UI/ErrorOverlay\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nfunction ManageExpense(_ref) {\n  var _route$params;\n\n  var route = _ref.route,\n      navigation = _ref.navigation;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isSubmitting = _useState2[0],\n      setIsSubmitting = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var expensesCtx = useContext(ExpensesContext);\n  var editedExpenseId = (_route$params = route.params) == null ? void 0 : _route$params.expenseId;\n  var isEditing = !!editedExpenseId;\n  var selectedExpense = expensesCtx.expenses.find(function (expense) {\n    return expense.id === editedExpenseId;\n  });\n  useLayoutEffect(function () {\n    navigation.setOptions({\n      title: isEditing ? \"Edit Expense\" : \"Add Expense\"\n    });\n  }, [navigation, isEditing]);\n\n  function deleteExpenseHandler() {\n    return _regeneratorRuntime.async(function deleteExpenseHandler$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            setIsSubmitting(true);\n            _context.prev = 1;\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(deleteExpense(editedExpenseId));\n\n          case 4:\n            expensesCtx.deleteExpense(editedExpenseId);\n            navigation.goBack();\n            _context.next = 12;\n            break;\n\n          case 8:\n            _context.prev = 8;\n            _context.t0 = _context[\"catch\"](1);\n            setError(\"Could not delete expense - please try again later\");\n            setIsSubmitting(false);\n\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[1, 8]], Promise);\n  }\n\n  function cancelHandler() {\n    navigation.goBack();\n  }\n\n  function confirmHandler(expenseData) {\n    var id;\n    return _regeneratorRuntime.async(function confirmHandler$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            setIsSubmitting(true);\n            _context2.prev = 1;\n\n            if (!isEditing) {\n              _context2.next = 8;\n              break;\n            }\n\n            expensesCtx.updateExpense(editedExpenseId, expenseData);\n            _context2.next = 6;\n            return _regeneratorRuntime.awrap(updateExpense(editedExpenseId, expenseData));\n\n          case 6:\n            _context2.next = 12;\n            break;\n\n          case 8:\n            _context2.next = 10;\n            return _regeneratorRuntime.awrap(storeExpense(expenseData));\n\n          case 10:\n            id = _context2.sent;\n            expensesCtx.addExpense(_objectSpread(_objectSpread({}, expenseData), {}, {\n              id: id\n            }));\n\n          case 12:\n            navigation.goBack();\n            _context2.next = 19;\n            break;\n\n          case 15:\n            _context2.prev = 15;\n            _context2.t0 = _context2[\"catch\"](1);\n            setError(\"Could not save data - please try again later!\");\n            setIsSubmitting(false);\n\n          case 19:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[1, 15]], Promise);\n  }\n\n  function errorHandler() {\n    setError(null);\n  }\n\n  if (error && !isSubmitting) {\n    return _jsx(ErrorOverlay, {\n      message: error,\n      onConfirm: errorHandler\n    });\n  }\n\n  if (isSubmitting) {\n    return _jsx(LoadingOverlay, {});\n  }\n\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsx(ExpenseForm, {\n      submitButtonLabel: isEditing ? \"Update\" : \"Add\",\n      onSubmit: confirmHandler,\n      onCancel: cancelHandler,\n      defaultValues: selectedExpense\n    }), isEditing && _jsx(View, {\n      style: styles.deleteContainer,\n      children: _jsx(IconButton, {\n        icon: \"trash\",\n        color: GlobalStyles.colors.error500,\n        size: 36,\n        onPress: deleteExpenseHandler\n      })\n    })]\n  });\n}\n\nexport default ManageExpense;\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    padding: 24,\n    backgroundColor: GlobalStyles.colors.primary800\n  },\n  deleteContainer: {\n    marginTop: 16,\n    paddingTop: 8,\n    borderTopWidth: 2,\n    borderTopColor: GlobalStyles.colors.primary200,\n    alignItems: \"center\"\n  }\n});","map":{"version":3,"sources":["D:/ReactNative/10 http/react-native/screens/ManageExpense.js"],"names":["useContext","useLayoutEffect","useState","ExpenseForm","Button","IconButton","GlobalStyles","ExpensesContext","storeExpense","updateExpense","deleteExpense","LoadingOverlay","ErrorOverlay","ManageExpense","route","navigation","isSubmitting","setIsSubmitting","error","setError","expensesCtx","editedExpenseId","params","expenseId","isEditing","selectedExpense","expenses","find","expense","id","setOptions","title","deleteExpenseHandler","goBack","cancelHandler","confirmHandler","expenseData","addExpense","errorHandler","styles","container","deleteContainer","colors","error500","StyleSheet","create","flex","padding","backgroundColor","primary800","marginTop","paddingTop","borderTopWidth","borderTopColor","primary200","alignItems"],"mappings":"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","sourcesContent":["import { useContext, useLayoutEffect, useState } from \"react\";\nimport { StyleSheet, TextInput, View } from \"react-native\";\n\nimport ExpenseForm from \"../components/ManageExpense/ExpenseForm\";\nimport Button from \"../components/UI/Button\";\nimport IconButton from \"../components/UI/IconButton\";\nimport { GlobalStyles } from \"../constants/styles\";\nimport { ExpensesContext } from \"../store/expenses-context\";\nimport { storeExpense, updateExpense, deleteExpense } from \"../util/http\";\nimport LoadingOverlay from \"../components/UI/LoadingOverlay\";\nimport ErrorOverlay from \"../components/UI/ErrorOverlay\";\n\nfunction ManageExpense({ route, navigation }) {\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [error, setError] = useState();\n  const expensesCtx = useContext(ExpensesContext);\n\n  const editedExpenseId = route.params?.expenseId;\n  const isEditing = !!editedExpenseId;\n\n  const selectedExpense = expensesCtx.expenses.find(\n    expense => expense.id === editedExpenseId\n  );\n\n  useLayoutEffect(() => {\n    navigation.setOptions({\n      title: isEditing ? \"Edit Expense\" : \"Add Expense\"\n    });\n  }, [navigation, isEditing]);\n\n  async function deleteExpenseHandler() {\n    setIsSubmitting(true);\n    try {\n      await deleteExpense(editedExpenseId);\n\n      expensesCtx.deleteExpense(editedExpenseId);\n      navigation.goBack();\n    } catch (error) {\n      setError(\"Could not delete expense - please try again later\");\n      setIsSubmitting(false);\n    }\n  }\n\n  function cancelHandler() {\n    navigation.goBack();\n  }\n\n  async function confirmHandler(expenseData) {\n    setIsSubmitting(true);\n    try {\n      if (isEditing) {\n        expensesCtx.updateExpense(editedExpenseId, expenseData);\n        await updateExpense(editedExpenseId, expenseData);\n      } else {\n        const id = await storeExpense(expenseData);\n        expensesCtx.addExpense({ ...expenseData, id: id });\n      }\n      navigation.goBack();\n    } catch (error) {\n      setError(\"Could not save data - please try again later!\");\n      setIsSubmitting(false);\n    }\n  }\n  function errorHandler() {\n    setError(null);\n  }\n  if (error && !isSubmitting) {\n    return <ErrorOverlay message={error} onConfirm={errorHandler} />;\n  }\n  if (isSubmitting) {\n    return <LoadingOverlay />;\n  }\n  return (\n    <View style={styles.container}>\n      <ExpenseForm\n        submitButtonLabel={isEditing ? \"Update\" : \"Add\"}\n        onSubmit={confirmHandler}\n        onCancel={cancelHandler}\n        defaultValues={selectedExpense}\n      />\n      {isEditing && (\n        <View style={styles.deleteContainer}>\n          <IconButton\n            icon=\"trash\"\n            color={GlobalStyles.colors.error500}\n            size={36}\n            onPress={deleteExpenseHandler}\n          />\n        </View>\n      )}\n    </View>\n  );\n}\n\nexport default ManageExpense;\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    padding: 24,\n    backgroundColor: GlobalStyles.colors.primary800\n  },\n  deleteContainer: {\n    marginTop: 16,\n    paddingTop: 8,\n    borderTopWidth: 2,\n    borderTopColor: GlobalStyles.colors.primary200,\n    alignItems: \"center\"\n  }\n});\n"]},"metadata":{},"sourceType":"module"}